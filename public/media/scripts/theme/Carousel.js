!function(t){var e=function(){function e(e,s){this.settings=t.extend(!0,t.fn.Carousel.defaults,s||{}),this.element=e,this.init()}return e.prototype={init:function(){var t=this;t.poster=t.element,t.posterItemMain=t.poster.find("ul.poster-list"),t.nextBtn=t.poster.find("div.poster-next-btn"),t.prevBtn=t.poster.find("div.poster-prev-btn"),t.posterItems=t.poster.find("li.poster-item"),t.posterItems.size()%2==0&&(t.posterItemMain.append(t.posterItems.ep(0).clone()),t.posterItems=t.posterItemMain.children),t.posterFirstItem=t.posterItems.first(),t.posterLastItem=t.posterItems.last(),t.rotateFlag=!0,t.setSettingValue(),t.setPosterPost(),t.nextBtn.click(function(){t.rotateFlag&&(t.rotateFlag=!1,t.carouseRotate("left"))}),t.prevBtn.click(function(){t.rotateFlag&&(t.rotateFlag=!1,t.carouseRotate("right"))}),t.settings.autoPlay&&(t.autoPlay(),t.poster.hover(function(){window.clearInterval(t.timer)},function(){t.autoPlay()}))},autoPlay:function(){var t=this;t.timer=window.setInterval(function(){t.nextBtn.click()},t.settings.delay)},carouseRotate:function(e){var s=this,i=[];"left"===e?(s.posterItems.each(function(){var e=t(this),n=e.prev().get(0)?e.prev():s.posterLastItem,o=n.width(),r=n.height(),h=n.css("zIndex"),a=n.css("opacity"),l=n.css("left"),p=n.css("top");i.push(h),e.animate({width:o,height:r,opacity:a,left:l,top:p},s.settings.speed,function(){s.rotateFlag=!0})}),s.posterItems.each(function(e){t(this).css("zIndex",i[e]),i[e]==Math.floor(s.posterItems.length/2)?t(this).find(".poster-item-title").slideDown("slow"):t(this).find(".poster-item-title").hide()})):"right"===e&&(s.posterItems.each(function(){var e=t(this),n=e.next().get(0)?e.next():s.posterFirstItem,o=n.width(),r=n.height(),h=n.css("zIndex"),a=n.css("opacity"),l=n.css("left"),p=n.css("top");i.push(h),e.animate({width:o,height:r,opacity:a,left:l,top:p},s.settings.speed,function(){s.rotateFlag=!0})}),s.posterItems.each(function(e){t(this).css("zIndex",i[e]),i[e]==Math.floor(s.posterItems.length/2)?t(this).find(".poster-item-title").slideDown("slow"):t(this).find(".poster-item-title").hide()}))},setPosterPost:function(){var e=this,s=e.posterItems.slice(1),i=s.size()/2,n=s.slice(0,i),o=Math.floor(e.posterItems.size()/2),r=s.slice(i),h=e.settings.posterWidth,a=e.settings.posterHeight,l=(e.settings.width-e.settings.posterWidth)/2/o,p=(e.settings.width-e.settings.posterWidth)/2,c=p+h;n.each(function(s){t(this).find(".poster-item-title").hide(),o--,h*=e.settings.scale,a*=e.settings.scale;var i=s;t(this).css({zIndex:o,width:h,height:a,opacity:1/++i,left:c+ ++s*l-h,top:e.setVertucalAlign(a)})});var g=n.last().width(),d=n.last().height(),f=Math.floor(e.posterItems.size()/2);r.each(function(s){t(this).find(".poster-item-title").hide(),t(this).css({zIndex:s,width:g,height:d,opacity:1/f,left:s*l,top:e.setVertucalAlign(d)}),g/=e.settings.scale,d/=e.settings.scale,f--})},setVertucalAlign:function(t){var e=this,s=e.settings.verticalAlign,i=0;return i="middle"===s?(e.settings.height-t)/2:"top"===s?0:"bottom"===s?e.settings.height-t:(e.settings.height-t)/2},setSettingValue:function(){var t=this;t.poster.css({width:t.settings.width,height:t.settings.height}),t.posterItemMain.css({width:t.settings.width,height:t.settings.height});var e=(t.settings.width-t.settings.posterWidth)/2;t.nextBtn.css({width:e,height:t.settings.height,zIndex:Math.ceil(t.posterItems.size()/2)}),t.prevBtn.css({width:e,height:t.settings.height,zIndex:Math.ceil(t.posterItems.size()/2)}),t.posterFirstItem.css({width:t.settings.posterWidth,height:t.settings.posterHeight,top:t.setVertucalAlign(t.settings.posterHeight),left:e,zIndex:Math.floor(t.posterItems.size()/2)})}},e}();t.fn.Carousel=function(s){return this.each(function(){var i=t(this),n=i.data("Carousel");n||(n=new e(i,s),i.data("Carousel",n))})},t.fn.Carousel.defaults={width:1e3,height:519,posterWidth:436,posterHeight:519,scale:.9,speed:300,autoPlay:!0,delay:2e3,verticalAlign:"middle"}}(Zepto);