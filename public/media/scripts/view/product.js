require(["zepto","base","mylayer","loginReg","share"],function(e,r,i,t,s){var o={};o.init=function(){var r=this;e(".js-show-reserve").on("click",function(){var t=e("#reserve-box-template").html(),s=(i.init({content:t,close:!1,class_name:"layer-reserve layer-bottom bottom-to-top no-remove",position:"bottom",callback:function(){}}),e("#distpicker")),o={province:s.attr("data-province"),city:s.attr("data-city"),district:s.attr("data-district")};require(["jquery","distpicker"],function(e){e("#distpicker").distpicker(o)});new FormValidator("reserve-form",r.reserveFormRule,function(t,s){var o=e(s.target);if(o.find(".errormsg").html(""),t.length>0)return r.showValidatorError(t,o),!1;var a=(i.showLoad(!0),o.serializeObject());e.ajaxPost("/api/product/reserve",a,function(r){if(i.hideLoad(),"Success"==r.code){i.showTip(r.message,3e3,"success");var t=e(".layer-reserve");i.hideLayer(t)}else i.hideLoad(),e.showRequestError(r)})});e(".store-info-form").on("submit",function(){return!1})}),this.addRecently()},o.reserveFormRule=[{name:"fullname",rules:"required|max_length[50]",message:{required:"请输入姓名！"}},{name:"phone",rules:"required|max_length[50]",message:{required:"请输入电话！"}},{name:"province",rules:"required",message:{required:"请选择省份！"}},{name:"city",rules:"required",message:{required:"请选择城市！"}},{name:"district",rules:"required",message:{required:"请选择区！"}},{name:"address",rules:"required",message:{required:"请输入地址！"}}],o.addRecently=function(){var r=e("#goods_id").val();r&&e.ajaxPost("/product/viewed",{id:r},function(){})},"function"==typeof o.init&&e(function(){o.init()})});