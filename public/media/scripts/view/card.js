require(["zepto","base","mylayer","validate","scrollComponent","lazyload"],function(t,a,o,n,i,e){var l={init:function(){var a=this,n=t("#card_id").val();this.post(),t(".musicBtn").on("click",function(){var o=t(this);o.attr("data-play")&&"1"==o.attr("data-play")?(a.stop(),t(this).removeAttr("data-play"),o.removeClass("play")):(a.music(),t(this).attr("data-play","1"),o.addClass("play"))}),t(".simple-microlink-item svg").attr("fill",function(){return"#ffffff"}),t(".js-show-map").on("click",function(){var a=t("#card_address"),n=a.attr("data-province"),i=a.attr("data-city"),e=a.attr("data-district"),l=a.attr("data-address-street"),s=n+i+e+l;if(null==s)return o.showTip("用户未设置地址！",5e3,"error"),!1;var r=t("#map-template").html();o.init({content:r,close:!1,class_name:"layer-map",position:"top",callback:function(){c.init(s)}})}),t(".js-show-qr").on("click",function(){var a=t("#qr-box-template").html();o.init({content:a,close:!1,class_name:"layer-qr layer-bottom bottom-to-top",position:"bottom",callback:function(){}})}),t(".js-show-weixin").on("click",function(){var a=t("#weixin-box-template").html();o.init({content:a,close:!1,class_name:"layer-weixin layer-bottom bottom-to-top",position:"bottom",callback:function(){}})}),t.ajaxPost("/card/viewed",{id:n},function(){})},post:function(){var a=this,o=t(".js-post-list-box");t("#card_id").val();o.addClass("loading"),o.find(".js-load-block").show();var n=o.attr("data-action");t.ajaxGet(n,{page:"1"},function(a){o.removeClass("loading"),o.find(".js-load-block").hide(),""!=a.view&&(t(".card-post-box").show(),o.find(".js-card-post-list").html(a.view)),t.imgLazyLoad()}),i.init(),i.setScrollItem(o),i.setCallback(function(t,o){a.scrollLoadCallback(t,o)})},scrollLoadCallback:function(a,o){var n=t(".js-post-list-box");n.find(".js-card-post-list").append(a),t.imgLazyLoad()},stop:function(){var t=document.getElementById("card-music-audio");t.currentTime=0,t.pause()},music:function(){var t=document.getElementById("card-music-audio");null!=t&&(t.load(),t.play())}},c={init:function(t){var a,o=new BMap.Map("allmap"),n=new BMap.Geocoder;t&&n.getPoint(t,function(t){if(t){o.centerAndZoom(t,16),a=new BMap.Marker(t),o.addOverlay();var n=new BMap.InfoWindow("");a.addEventListener("click",function(){this.openInfoWindow(n)})}}),o.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),o.enableScrollWheelZoom(!0);new BMap.ContextMenu}};"function"==typeof l.init&&t(function(){l.init()})});