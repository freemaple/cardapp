define(["zepto"],function(t){var a={init:function(t){this.scrollitem=t,this.initEvent()},initEvent:function(){var a=this;t(window).on("scroll",function(){a.onscroll()}),this.x=setInterval(function(){a.onscroll()},1e3)},onscroll:function(){var a=this;if(a.scrollitem&&a.scrollitem.size()>0){var o=a.scrollitem,e=a.isScrollBottom(o);if(!e)return!1;var n=!!o.hasClass("loading");if(n)return!1;var i=o.attr("data-load-more");if("-1"==i)return!1;var l=o.find(".js-load-block");l.show(),o.addClass("loading");var r=o.attr("data-action"),s=parseInt(o.attr("data-page"))?parseInt(o.attr("data-page")):0,c=s+1;t.ajaxGet(r,{page:c},function(t){if("Success"==t.code&&t.data){o.attr("data-page",c);var e="undefined"!=typeof t.view?t.view:t.data;e?"function"==typeof a.callback&&a.callback(e,o):o.attr("data-load-more","-1"),t.data.last_page&&t.data.last_page==c&&o.attr("data-load-more","-1"),o.removeClass("loading")}else o.attr("data-load-more","-1");l.hide()})}},isScrollBottom:function(a){var o=document.documentElement.clientHeight,e=t(window).scrollTop(),n=a.offset().top,i=a.height(),l=e+o-n-i;return l>=-20},setScrollItem:function(t){this.scrollitem=t},setCallback:function(t){this.callback=t}};return a});