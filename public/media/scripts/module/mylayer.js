define(["zepto"],function(e){var o={};return o.init=function(o){var n=this,t={overlay:!0,close:!0,header:!1,title:"",content:"",layerClose:!0,position:"center"};t=e.extend(t,o);var a=0;e(".layerbox").each(function(){var o=parseInt(e(this).css("z-index"))+1;o>a&&(a=o)}),a=a<=1001?1001:a;var s=this.random();t.id=s;var i=this.layerContent(t);e("body").append(i),t.callback&&"function"==typeof t.callback&&t.callback();var r="layerbox-"+s,c=e("#"+r);if(c.css({"z-index":a}),n.initEvent(t),t.overlay){e("body").append('<div class="overlay" data-id="'+s+'" id="overlay-'+s+'"></div>');var l=e("#overlay-"+s);l.show().css("z-index",a-1),e(".overlay").on("click",function(){var o=e(this).attr("data-id");n.closeLayer(o)})}c.find(".layerbox-wrapper");return c.addClass("show"),c.off("click").on("click",function(e){e.target.id==r&&t.layerClose===!0&&("function"==typeof t.closeEvent&&t.closeEvent(),n.closeLayer(s))}),"center"==t.position&&(e(window).on("resize",function(){n.resizeLayer(c)}),n.resizeLayer(c)),e("body").addClass("overfixed"),"top"==t.position&&e(".wrap-container").hide(),c},o.initEvent=function(o){var n=this;e(".layerbox .yes").off("click").on("click",function(){"function"==typeof o.yesBtn&&o.yesBtn();var t=e(this).closest(".layerbox").attr("data-id");n.closeLayer(t)}),e(".layerbox .no").off("click").on("click",function(){"function"==typeof o.noBtn&&o.noBtn();var t=e(this).closest(".layerbox").attr("data-id");n.closeLayer(t)}),e(".layerbox .js-close-layer").off("click").on("click",function(){"function"==typeof o.closeBtn&&o.closeBtn();var t=e(this).closest(".layerbox").attr("data-id");"function"==typeof o.closeEvent&&o.closeEvent(),n.closeLayer(t)})},o.showLayer=function(o){if(o.size()>0&&o.hasClass("layerbox")){var n=o.attr("data-id");o.addClass("show");var t=e("#overlay-"+n);t.show(),e("body").addClass("overfixed")}},o.hideLayer=function(e){if(e.size()>0&&e.hasClass("layerbox")){var o=e.attr("data-id");this.closeLayer(o)}},o.closeLayer=function(o){var n=e("#layerbox-"+o);n.hasClass("no-remove")?(n.removeClass("show"),e("#overlay-"+o).hide()):(n.size()>0&&(n.removeClass("show"),setInterval(function(){n.remove()},300)),e("#overlay-"+o).remove()),0!==e(".layerbox").size()&&0!=e(".layerbox.show").length||e(".wrap-container").show(),e("body").removeClass("overfixed")},o.showMessage=function(o,n){var t='<div class="layer-message clearfix"><div class="layer-message-content">'+o+"</div></div>";return this.init({content:t,yes:!0,yesText:"确定",yesBtn:!0,close:!1,class_name:"show-layer-message",closeEvent:n,yesBtn:function(){"function"==typeof n&&n()},closeBtn:function(){e("body").removeClass("overfixed"),"function"==typeof n&&n()}})},o.showConfirm=function(e,o){var n='<div class="layer-message clearfix"><span class="layer-icon layer-icon-confirm"></span><span class="msg_content">'+e+"</span></div>";return this.init({content:n,header:!0,title:"提示",close:!1,yes:!0,yesText:"确定",noText:"取消",class_name:"show-layer-message layer-confirm",yesBtn:function(){"function"==typeof o&&o()},no:!0})},o.showLoad=function(o){0==e(".layer-load").size()&&e("body").append('<div class="layer-load"><div class="layer-loading"><span></span></div></div>'),e(".layer-load").show(),o&&(0==e(".layer-cover").size()&&e("body").append('<div class="layer-cover"></div>'),e(".layer-cover").show())},o.hideLoad=function(){e(".layer-load").hide(),e(".layer-cover").hide()},o.showLayerTop=function(e,o){return this.init({content:e,close:!1,position:"top",callback:o,class_name:"layer-top bottom-to-top"})},o.showLayerLeftTop=function(e,o){return this.init({content:e,close:!0,position:"top",callback:o,class_name:"layer-top left-to-top"})},o.showLayerBottom=function(e,o){return this.init({content:e,close:!0,class_name:"layer-bottom bottom-to-top",position:"bottom",callback:o})},o.layerContent=function(e){var o=e.id?e.id:"",n=e.content?e.content:"",t="";e.header?(t='<h4 class="layerbox-wrapper-title">',e.close&&(t+='<a href="javascript:void(0)" title="close" class="layerbox-close-btn js-close-layer"><span class="iconfont icon-close"></span></a>'),t+=e.title+"</h4>"):e.close&&(t='<a href="javascript:void(0)" title="close" class="layerbox-close-btn js-close-layer"><span class="iconfont icon-close"></span></a>');var a="",s="";e.no&&(s+='<a class="layerbox-button no" href="javascript:void(0)">'+e.noText+"</a>"),e.yes&&(s+='<a class="layerbox-button yes" href="javascript:void(0)">'+e.yesText+"</a>"),s&&(a='<div class="layerbox-footer">'+s+"</div>");var i='<div class="layerbox '+(e.class_name?e.class_name:"")+'" id="layerbox-'+o+'" data-id="'+o+'">            <div class="layerbox-wrapper">                <div class="layerbox-content">'+t+'<div class="layerbox-wrapper-text">'+n+"</div>"+a+"</div>            </div>        </div>";return i},o.showTip=function(o,n,t,a){if(0==e(".popover-inner").size()){var s='<div class="popover-inner"><div class="popover-inner-content"></div></div>';e("body").append(s)}"success"==t?e(".popover-inner").removeClass("error").addClass("success"):e(".popover-inner").removeClass("success").addClass("error"),a?e(".popover-inner").addClass(a):e(".popover-inner").addClass("center"),e(".popover-inner").show(),e(".popover-inner-content").html(o),setTimeout(function(){e(".popover-inner").hide()},n?n:3e3)},o.hideTip=function(){e(".popover-inner").hide()},o.random=function(){var e=parseInt((new Date).getTime()/1e3),o=Math.floor(1e5*Math.random());return e+""+o},o.getWinHeight=function(){return window.innerHeight?winHeight=window.innerHeight:document.body&&document.body.clientHeight&&(winHeight=document.body.clientHeight),document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth&&(winHeight=document.documentElement.clientHeight),winHeight},o.resizeLayer=function(e){var o=e.find(".layerbox-wrapper");o.css({left:"50%","margin-left":"-"+o.width()/2+"px",top:"50%","margin-top":"-"+o.height()/2+"px"})},o});